Виртуальная машина языка Leo

Написана на языке c++ с вдохновлением реализацией виртуальной машины языка Python.

### Сборка

`make leovm` в корневом каталоге всего проекта (./LEO)

Для сборки используется компилятор g++

Имя выходного файла - `leovm` или `leovm.exe` в случае сборки на OC Windows.

### Использование

Ассоциированное расширение с программой на байткоде `*.leo.bin`

Выполнение программы на байткоде

`leovm source.leo.bin`

Выполнение программы на байткоде с замером времени выполнения

`leovm source.leo.bin -t`

Дизассемблирование программы без выполнения

`leovm source.leo.bin -S`

Получение справки

`leovm -h`

Получение версии виртуальной машины

`leovm -v`

### Какой производительности ожидать от виртуальной машины?

Проверьте сами, в папке LEO/examples написаны тестовые программы!

### Структура скомпилированного бинарного файла программы

unsigned long = 4 байта
unsigned char - 1 байт
long long - 8 байт
double - 8 байт
bool - 1 байт
command - 2 байта, беззнаковое число

```
**Шапка:**
unsigned long - количество переменных
unsigned long - количество констант
unsigned long - количество команд
**Константы:**
Повторять {количество констант} раз:
    unsigned char - тип константы (0 = Int, 1 = Float, 2 = Bool)
    Если Int, то:
        long long - значение константы
    Иначе если Float, то:
        double - значение константы
    Иначе если Bool, то:
        bool - значение константы
**Команды**
Повторять {количество команд} раз:
    command - команда или аргумент команды
```


### Описание системы команд виртуальной машины

слово = 2 байта

Виртуальная машина имеет смешанную систему команд, таким образом, все команды, кроме (JIT, JIF, GOTO, INPUT, LOAD, LOAD_CONST, STORE) занимают 1 слово, а все исключённые - 2 (1 слово команды + 1 слово аргумента).

| Команда    | Семантика                                | Стек              | Аргументы команды |
|:----------:|:----------------------------------------:|:-----------------:|:-----------------:|
| ADD        | сложение                                 | a, b -> a + b     | нет               |
| SUB        | вычитание                                | a, b -> a - b     | нет               |
| MUL        | умножение                                | a, b -> a * b     | нет               |
| DIV        | деление                                  | a, b -> a / b     | нет               |
| IDIV       | целочисленное деление                    | a, b -> a // b    | нет               |
| MOD        | остаток от деления                       | a, b -> a % b     | нет               |
| NOT        | отрицание                                | a -> !a | нет     | нет               |
| OR         | логическое или                           | a, b -> a || b    | нет               |
| AND        | логическое и                             | a, b -> a && b    | нет               |
| LT         | меньше                                   | a, b -> a < b     | нет               |
| LTE        | меньше или равно                         | a, b -> a <= b    | нет               |
| GT         | больше                                   | a, b -> a > b     | нет               |
| GTE        | больше или равно                         | a, b -> a >= b    | нет               |
| EQ         | равно                                    | a, b -> a == b    | нет               |
| NEQ        | не равно                                 | a, b -> a != b    | нет               |
| JIT        | переход, если истина                     | a ->              | адрес перехода    |
| JIF        | переход, если ложь                       | a ->              | адрес перехода    |
| GOTO       | переход                                  | не меняет         | адрес перехода    |
| INPUT      | ввод                                     |  -> a             | тип переменной    |
| OUTPUT     | вывод                                    | a ->              | нет               |
| LOAD       | загрузка значения переменной в стек      |  -> a             | адрес переменной  |
| LOAD_CONST | загрузка константы в стек                |  -> a             | адрес константы   |
| STORE      | выгрузка значения из стека в переменную  | a ->              | адрес переменной  |
| DUP        | дублирование указателя на объект в стеке | a -> a, a         | нет               |
| STOP       | остановка виртуальной машины             | не меняет         | нет               |

### RunTime ошибки

1. ZIRO_DIVISION - деление на 0
2. UNRESOLVED_OPERATION - тип не поддерживает операцию (возможно только при ручной компиляции)
3. UNRESOLVED_OPCODE - неопределённый опкод (возможно только при ручной компиляции)

> Ошибка недостатка памяти не является ожидаемой для данной программной системы, так как все типы легковесные.
